# Weather Project

Это backend-сервис на Spring Boot, который предоставляет информацию о погоде для городов по всему миру, интегрируясь с API OpenWeatherMap.

## Функционал

1. Получение текущих данных о погоде для любого города
2. Поддержка метрических (°C) и имперских (°F) единиц измерения
3. Поддержка нескольких языков для описания погоды
4. Кэширование данных о погоде для уменьшения количества вызовов API
5. Комплексная обработка ошибок
6. Валидация входных данных
7. Подробное логирование
8. RESTful API

## Технологии

1. Java 17
2. Spring Boot 3.4.6
3. Spring Web MVC
4. Feign Client - для взаимодействия с API
5. Lombok - для сокращения boilerplate кода
6. Caffeine Cache - для кэширования ответов
7. JUnit 5 - для модульного тестирования
8. Spring Validation - для валидации запросов
9. Logback - для логирования

## API Endpoints

### Получение данных о погоде

GET /weather?city={city}&units={units}&lang={lang}

Параметры:
- city (обязательный) - название города (только буквы, пробелы и дефисы)
- units (опциональный, по умолчанию "metric") - единицы измерения ("metric" или "imperial")
- lang (опциональный, по умолчанию "ru") - язык описания (2-буквенный код)

Пример успешного ответа:
{
"city": "Minsk",
"temperature": 15.5,
"humidity": 75,
"weatherDescription": "ясно",
"icon": "01d"
}

## Структура проекта

src/main/java/renata/valkanouskaya/weather_project/
├── client/                                  # Feign клиенты для внешних API
│   ├── geocoding/                   
│   │   ├── dto/                             # DTO
│   │   └── GeocodingApiClient.java          # Клиент геокодинга (чтобы по названию города получить координаты долготы и широты)
│   └── weather/                     
│       ├── dto/                             # DTO
│       └── CurrentWeatherDataApiClient.java # Клиент погоды (по координатам долготы и широты выводит данные о погоде местности)
├── configuration/                           # Конфигурационные классы
│   └── FeignConfig.java                     # Конфигурация для внешних API
├── controller/                              # REST контроллеры
│   ├── impl/                                # Реализации контроллеров
│   └── WeatherController.java               # Интерфейс контроллера
├── exceptions/                              # Кастомные исключения
├── mapper/                                  # Преобразователи между DTO
├── model/                                   # DTO и доменные объекты
├── service/                                 # Бизнес-логика
│   ├── impl/                                # Реализации сервисов
│   └── WeatherService.java                  # Интерфейс сервиса
└── WeatherProjectApplication.java           # Главный класс приложения

## Запуск проекта

1. Склонируйте репозиторий
2. Установите переменную окружения APP_WEATHER_API_KEY с вашим API ключом OpenWeatherMap
3. Запустите приложение

## Кэширование

Сервис использует кэширование через Spring Cache Abstraction с Caffeine:

1. Ответы о погоде кэшируются на 10 минут
2. Ключ кэша включает название города, единицы измерения и язык
3. Максимальный размер кэша - 100 записей

Настройки кэширования можно изменить в application.yml

## Обработка ошибок

1. CityNotFoundException (404) - Город не найден
2. WeatherServiceUnavailableException (503) - Сервис погоды недоступен
3. ConstraintViolationException (400) - Ошибки валидации

Все исключения обрабатываются GlobalExceptionHandler, который возвращает соответствующие HTTP статусы и сообщения об ошибках.

## Валидация

1. Название города (минимальная длина 2 символа, максимальная длина 100 символов, разрешены только буквы, пробелы и дефисы)
2. Единицы измерения (должны быть "metric" или "imperial")
3. Язык (должен быть 2-буквенным кодом)